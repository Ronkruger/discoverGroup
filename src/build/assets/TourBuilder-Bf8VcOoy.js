import{i as nt,u as rt,a as x,f as at,k as lt,j as e,L as Pe}from"./index-COMo_l_O.js";function ot(){const{slug:L}=nt(),Te=rt(),[l,F]=x.useState(void 0),[q,Ce]=x.useState([]),[P,Ee]=x.useState(null),[g,R]=x.useState(null),[p,T]=x.useState(null),[M,Q]=x.useState(1),[U,le]=x.useState(!1),[A,H]=x.useState(1),[_,Z]=x.useState(null),[d,G]=x.useState(null),[k,S]=x.useState(null),ke=x.useRef(null),ee=x.useRef(null),ie=x.useRef(null),V=x.useRef({}),[Ie,oe]=x.useState([]),[Le,ce]=x.useState([]),W={RED:"bg-red-500",BLUE:"bg-blue-500",GREEN:"bg-green-500",YELLOW:"bg-yellow-500",BROWN:"bg-yellow-900",ROUTE_A:"bg-rose-600",DEFAULT:"bg-gray-400"},N={RED:"#ef4444",BLUE:"#3b82f6",GREEN:"#10b981",YELLOW:"#f59e0b",BROWN:"#b45309",ROUTE_A:"#94a3b8",DEFAULT:"#94a3b8"};x.useEffect(()=>{at().then(Ce).catch(t=>console.error("fetchTours error:",t))},[]),x.useEffect(()=>{if(!L){F(null);return}F(void 0),lt(L).then(t=>{F(t),Ee(t?.travelWindow?.start??null),R(null),T(null),Z(null),G(null),Q(1),le(!1),H(1),S(null),setTimeout(()=>window.scrollTo({top:0,behavior:"smooth"}),60)}).catch(t=>{console.error("fetchTourBySlug error:",t),F(null)})},[L]);function Ae(t){if(!t)return[];const s=t.itinerary?.length??t.durationDays??0,r=Array(s).fill(void 0),n=t.fullStops??[];let i=0;for(const o of n){const a=typeof o.days=="number"&&o.days>0?o.days:1;for(let f=0;f<a&&i<s;f+=1,i+=1)r[i]=o}if(i<s){const o=r[Math.max(0,i-1)]??n[n.length-1];for(let a=i;a<s;a+=1)r[a]=o}const m=n[0];if(m)for(let o=0;o<s;o+=1)r[o]||(r[o]=m);return r}function de(t,s=0){if(!t)return[];const r=t.itinerary?.length??t.durationDays??0,n=t.fullStops??[],i=[];let m=0;for(const o of n){const a=typeof o.days=="number"&&o.days>0?o.days:1,f=s+m,u=Math.min(s+m+a-1,s+r-1);i.push({stop:o,start:f,end:u}),m+=a}return m<r&&i.length>0&&(i[i.length-1].end=s+r-1),i.length===0&&n.length>0&&i.push({stop:n[0],start:s,end:s+Math.max(0,r-1)}),i}const Se=Ae(l),j=l?.itinerary??[],h=de(l,0),te=d?de(d.tour,d.insertAfterIndex+1):[];function $e(){if(!d||!l)return{mergedRanges:h.slice(),mergedLength:j.length};const t=d.tour.itinerary?.length??d.tour.durationDays??0,s=d.insertAfterIndex,r=[],n=[];for(let o=0;o<h.length;o+=1){const a=h[o],f=o===h.length-1;if(a.end<s){r.push({...a});continue}if(a.start>s){n.push({stop:a.stop,start:a.start+t,end:a.end+t});continue}if(f&&a.start<=s){n.push({stop:a.stop,start:a.start+t,end:a.end+t});continue}if(a.start<=s&&a.end>=s){r.push({stop:a.stop,start:a.start,end:s});const u=s+1+t,v=a.end+t;n.push({stop:a.stop,start:u,end:v})}}const i=[...r,...te,...n],m=j.length+t;return{mergedRanges:i,mergedLength:m}}const{mergedRanges:D,mergedLength:$}=$e();function Be(){const t=$??j.length,s=Array(t).fill(void 0);if(D&&D.length)for(const n of D)for(let i=n.start;i<=n.end&&i<t;i+=1)s[i]=n.stop;const r=s.find(n=>!!n);for(let n=0;n<t;n+=1)s[n]||(s[n]=n>0?s[n-1]??r:r);return s}const ue=Be();function Fe(){const t=$??j.length,s=Array.from({length:t},()=>[]);if(!D||D.length===0)return s;for(let r=0;r<t;r+=1)for(const n of D)if(n.start<=r&&r<=n.end){const i=n.stop?.city;if(!i)continue;const o=(d?te.some(f=>f.stop===n.stop&&f.start===n.start&&f.end===n.end):!1)?"insert":"base",a=o==="insert"?N[d.tour.line??"DEFAULT"]??N.DEFAULT:N[l.line??"DEFAULT"]??N.DEFAULT;s[r].some(f=>f.city===i&&f.source===o)||s[r].push({city:i,colorHex:a,source:o})}return s}const xe=Fe(),C=$??j.length,E=ue.length?ue:Se,Me=xe.length?xe:(()=>{const t=j.length,s=Array.from({length:t},()=>[]);if(l){const r=N[l.line??"DEFAULT"]??N.DEFAULT;for(let n=0;n<t;n+=1)for(const i of h)if(i.start<=n&&n<=i.end){const m=i.stop?.city;m&&!s[n].some(o=>o.city===m&&o.source==="base")&&s[n].push({city:m,colorHex:r,source:"base"})}}return s})();x.useEffect(()=>{if(!ee.current)return;const t=ee.current.getBoundingClientRect(),s=Array(C).fill(null);for(const c of D){const w=(d?te.some(y=>y.stop===c.stop&&y.start===c.start&&y.end===c.end):!1)?N[d.tour.line??"DEFAULT"]??N.DEFAULT:N[l.line??"DEFAULT"]??N.DEFAULT;for(let y=c.start;y<=c.end&&y<C;y+=1)s[y]=w}const r=[];let n=0;for(;n<C;){const c=s[n];if(!c){n+=1;continue}let b=n;for(;b+1<C&&s[b+1]===c;)b+=1;r.push({start:n,end:b,color:c}),n=b+1}const i=ie.current?.getBoundingClientRect(),o=(i?i.left+i.width/2:t.left+28)-t.left,a=12,f=Math.max(o-a/2,6),et=Math.max(t.width-44,o+80)-a/2,X=[];for(let c=0;c<r.length;c+=1){const b=r[c],w=V.current[b.start],y=V.current[b.end];if(!w||!y)continue;const re=w.getBoundingClientRect(),Y=y.getBoundingClientRect(),B=Math.round(re.top-t.top),J=Math.round(Y.bottom-t.top),K=Math.max(12,J-B),ae=(c%2===0?"right":"left")==="right"?et:f;X.push({top:B,height:K,color:b.color,x:ae})}oe(X);const Ne=[];for(let c=0;c<r.length-1;c+=1){const b=r[c],w=r[c+1];if(b.end+1!==w.start||b.color===w.color)continue;const y=c%2===0?"right":"left",re=(c+1)%2===0?"right":"left";if(y===re)continue;const Y=X[c],B=X[c+1];if(!Y||!B)continue;const J=Y.x+a/2,K=B.x+a/2,we=Math.min(J,K),ae=Math.max(8,Math.abs(K-J)),Re=V.current[w.start];if(!Re)continue;const De=Re.getBoundingClientRect(),tt=Math.round(De.top-t.top+De.height/2-3),st=`linear-gradient(90deg, ${b.color}33 0%, ${w.color}33 100%)`;Ne.push({left:we,top:tt,width:ae,gradient:st})}ce(Ne);const ve=()=>{setTimeout(()=>{oe(c=>[...c]),ce(c=>[...c])},60)};return window.addEventListener("resize",ve),()=>window.removeEventListener("resize",ve)},[D,d,C,l]);function me(t){if(!t)return"—";const s=typeof t=="string"?new Date(t):t;return Number.isNaN(s.getTime())?"—":s.toLocaleDateString(void 0,{weekday:"short",day:"numeric",month:"short"})}function Ue(t){if(!t)return"—";const s=typeof t=="string"?new Date(t):t;return Number.isNaN(s.getTime())?"—":s.toLocaleDateString(void 0,{weekday:"short"}).toUpperCase()}function He(t){if(!t)return"—";const s=typeof t=="string"?new Date(t):t;return Number.isNaN(s.getTime())?"—":s.toLocaleDateString(void 0,{day:"numeric",month:"short"}).toUpperCase()}function fe(t){if(!P)return"";const r=new Date(P).getTime()+t*24*60*60*1e3;return new Date(r).toISOString()}function he(){return g!==null&&p!==null&&p>=g?p-g+1:d&&typeof $=="number"?$:l?.durationDays??j.length??0}function ge(t){if(!t)return 0;const s=t;if(typeof s.regularPricePerPerson=="number")return s.regularPricePerPerson;if(typeof s.promoPricePerPerson=="number")return s.promoPricePerPerson;if(typeof s.basePricePerDay=="number"){const r=t.durationDays??t.itinerary?.length??0;return s.basePricePerDay*r}return 0}function se(){const t=ge(l),s=d?ge(d.tour):0,r=t+s;return{base:t,insert:s,totalPerPerson:r}}function _e(){return se().totalPerPerson*Math.max(1,M??1)}function I(t,s=!1){return s?`PHP ${Math.round(t).toLocaleString("en-PH")}`:`PHP ${t.toLocaleString("en-PH",{minimumFractionDigits:2,maximumFractionDigits:2})}`}function Ge(){const t=_e();return U&&A>0?`${I(t)} + ${A} infant(s) (TBD)`:I(t)}function Ve(){const{base:t,insert:s,totalPerPerson:r}=se();return d?{lines:[{label:"Base per head",value:I(t)},{label:"Inserted per head",value:I(s)}],totalLabel:"Per head (total)",totalValue:I(r)}:{lines:[{label:"Per head",value:I(t)}],totalLabel:void 0,totalValue:void 0}}function We(){if(!P)return null;const t=new Date(P),s=he(),r=t.getTime()+(s-1)*24*60*60*1e3;return new Date(r).toISOString()}function pe(t){Q(s=>Math.max(1,s+t))}function ze(t){const s=parseInt(t.target.value,10);Number.isNaN(s)||s<1||Q(s)}function be(t){H(s=>Math.max(1,s+t))}function Oe(t){const s=parseInt(t.target.value,10);Number.isNaN(s)||s<1||H(s)}function Xe(t){if(g===null&&p===null){R(t),T(t);return}if(g!==null&&p===null){t<g?R(t):T(t);return}g!==null&&p!==null&&(t<g?R(t):t>p?T(t):R(t))}const z=t=>!t||typeof t!="string"?null:t.split(",")[0].trim(),Ye=(()=>{if(g!==null&&E[g]?.city)return E[g].city;if(d){const s=d.tour.fullStops?.[0]?.city??z(d.tour.additionalInfo?.startingPoint);if(s)return s}if(h&&h.length>0&&h[0].stop?.city)return h[0].stop.city;const t=z(l?.additionalInfo?.startingPoint);return t||(E[0]?.city??"—")})(),Je=(()=>{if(p!==null&&E[p]?.city)return E[p].city;if(d){const s=d.tour.fullStops??[],n=(s.length?s[s.length-1]?.city:void 0)??z(d.tour.additionalInfo?.endingPoint);if(n)return n}if(h&&h.length>0&&h[h.length-1].stop?.city)return h[h.length-1].stop.city;const t=z(l?.additionalInfo?.endingPoint);return t||(E[Math.max(C-1,0)]?.city??"—")})();function Ke(t){Z(s=>s===t?null:t),_===t&&G(null),setTimeout(()=>document.getElementById(`tb-row-${t}`)?.scrollIntoView({behavior:"smooth",block:"center"}),120)}function qe(t){const s=q.find(r=>r.slug===t);!s||_===null||!l||(G({tour:s,insertAfterIndex:_}),Z(null))}function ye(){G(null)}function Qe(){R(null),T(null)}if(l===void 0)return e.jsx("div",{className:"p-8",children:e.jsxs("div",{className:"animate-pulse space-y-4 max-w-4xl",children:[e.jsx("div",{className:"h-56 rounded-2xl bg-slate-200"}),e.jsx("div",{className:"h-6 w-3/4 rounded bg-slate-200"}),e.jsx("div",{className:"h-40 rounded-2xl bg-slate-100"})]})});if(l===null)return e.jsxs("div",{className:"p-8",children:[e.jsx("h2",{className:"text-2xl font-semibold text-slate-900 mb-3",children:"Route not found"}),e.jsx("p",{className:"text-slate-600 mb-6",children:"Please choose another route to customize."}),e.jsx("div",{className:"max-w-md",children:e.jsxs("select",{"aria-label":"Choose a route",className:"w-full border rounded-xl px-4 py-3 bg-white shadow-sm",onChange:t=>Te(`/tour/builder/${t.target.value}`),defaultValue:"",children:[e.jsx("option",{value:"",disabled:!0,children:"Choose a route..."}),q.map(t=>e.jsx("option",{value:t.slug,children:t.title},t.slug))]})})]});const O=Ve(),ne=!!(l&&P),Ze={background:"linear-gradient(180deg, rgba(2,18,51,1) 0%, rgba(8,42,102,1) 35%, rgba(4,18,55,1) 100%)","--accent-yellow":"#FFD24D","--accent-yellow-600":"#FFC107","--muted-slate":"#94a3b8"},je=l?.additionalInfo?.countriesVisited??[];return e.jsxs("div",{className:"min-h-screen py-10",style:Ze,children:[e.jsx("style",{children:`
        .accent-yellow { color: var(--accent-yellow); }
        .bg-accent-yellow { background-color: var(--accent-yellow); }
        .ring-accent-yellow { box-shadow: 0 0 0 3px rgba(255,210,77,0.12); }
        .tab-underline { transition: transform .25s cubic-bezier(.2,.9,.2,1), opacity .25s; }
        .fade-enter { opacity: 0; transform: translateY(6px); }
        .fade-enter-active { opacity: 1; transform: translateY(0); transition: all .28s ease; }
        .card-glass { background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); backdrop-filter: blur(6px); border: 1px solid rgba(255,255,255,0.06); }
        .modal-backdrop { background: rgba(2,6,23,0.6); }

        /* Timeline highlight adjustments */
        .timeline-section { padding: 24px; border-radius: 18px; }
        .timeline-rail { background: linear-gradient(180deg, rgba(255,255,255,0.04), rgba(255,255,255,0.02)); width: 2px; }
        .timeline-row { transition: background .18s ease, transform .12s ease; border-bottom: 1px solid rgba(255,255,255,0.04); }
        .timeline-row:hover { background: rgba(255,255,255,0.02); transform: translateY(-2px); }
        .timeline-card { background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); border: 1px solid rgba(255,255,255,0.04); }
        .timeline-marker { width: 44px; height: 44px; border-radius: 9999px; display: grid; place-items: center; }
        .timeline-marker.included { background: linear-gradient(180deg,#2563eb,#1e40af); box-shadow: 0 6px 20px rgba(2,6,23,0.5); color: white; border: 2px solid rgba(255,255,255,0.06); }
        .timeline-marker.default { background: rgba(255,255,255,0.06); color: rgba(255,255,255,0.8); border: 1px solid rgba(255,255,255,0.04); }
        .timeline-bar { box-shadow: 0 8px 30px rgba(2,6,23,0.45); border-radius: 8px; opacity: 0.98; }
        .timeline-connector { opacity: 0.95; box-shadow: 0 6px 20px rgba(2,6,23,0.35); border-radius: 8px; }
        .timeline-heading { color: #e6eefc; font-weight: 700; }
        .timeline-sub { color: rgba(230,238,252,0.75); }
        .timeline-small { color: rgba(230,238,252,0.6); }

        /* Increase small font sizes by 5% inside timeline and card areas to improve readability */
        .timeline-section .text-xs,
        .timeline-section .timeline-small,
        .card-glass .text-xs,
        .card-glass .timeline-small {
          font-size: 105% !important;
          line-height: 1.25;
        }

        /* Badge interaction */
        .badge-filter { cursor: pointer; transition: transform .12s; }
        .badge-filter:hover { transform: translateY(-2px); }
        .badge-active { box-shadow: 0 6px 18px rgba(2,6,23,0.5); transform: scale(1.02); }
      `}),e.jsx("div",{ref:ke}),e.jsx("div",{className:"container mx-auto px-6 lg:px-12 text-slate-200",children:e.jsxs("div",{className:"grid lg:grid-cols-[minmax(0,1fr)_380px] gap-12",children:[e.jsx("div",{className:"space-y-8",children:e.jsxs("section",{className:"relative rounded-3xl card-glass shadow-sm overflow-visible p-6 timeline-section","aria-label":"Timeline",children:[e.jsx("div",{ref:ie,className:"absolute left-28 top-12 bottom-12 timeline-rail rounded-full"}),Ie.map((t,s)=>e.jsx("div",{"aria-hidden":!0,style:{position:"absolute",left:`${t.x}px`,top:`${t.top}px`,height:`${t.height}px`,width:12,borderRadius:8,background:t.color,boxShadow:"0 8px 28px rgba(2,6,23,0.45)",zIndex:6},className:"timeline-bar"},`bar-${s}`)),Le.map((t,s)=>e.jsx("div",{"aria-hidden":!0,style:{position:"absolute",left:`${t.left}px`,top:`${t.top}px`,height:8,width:`${t.width}px`,background:t.gradient,zIndex:7},className:"timeline-connector"},`conn-${s}`)),e.jsx("div",{className:"space-y-8",ref:ee,children:Array.from({length:C}).map((t,s)=>{const r=E[s],n=r?.country??"";if(k&&n&&k.toLowerCase()!==n.toLowerCase())return null;const i=r?.city??"",m=g!==null&&p!==null&&s>=g&&s<=p,o=r?.isEnd??!1,a=Me[s]??[],f=u=>{V.current[s]=u};return e.jsxs("div",{id:`tb-row-${s}`,ref:f,className:"relative flex items-start gap-6 pb-10 timeline-row last:border-b-0",children:[e.jsxs("div",{className:"w-28 flex flex-col items-center justify-start pt-1 text-left",children:[e.jsx("div",{className:"text-xs font-semibold timeline-heading",children:Ue(fe(s))}),e.jsx("div",{className:"text-xs timeline-sub mt-1",children:He(fe(s))})]}),e.jsx("div",{className:"absolute left-24 top-6",children:e.jsx("button",{onClick:()=>Xe(s),className:`timeline-marker ${m?"timeline-marker included":"timeline-marker default"}`,"aria-label":`Set segment point for day ${s+1}`,children:e.jsx("span",{className:`block w-4 h-4 rounded-full ${m?"bg-white":"bg-slate-400/40"}`})})}),e.jsxs("div",{className:`flex-1 ${m?"":"opacity-95"}`,children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"text-base font-semibold timeline-heading truncate",children:i||`Day ${s+1}`}),e.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[e.jsxs("span",{className:"inline-flex items-center gap-2 bg-white/6 text-slate-200 px-3 py-1 rounded-full text-sm",children:["• ",l?.durationDays??j.length," days"]}),l?.guaranteedDeparture&&e.jsx("span",{className:"inline-flex items-center gap-2 bg-emerald-600/20 text-emerald-200 px-3 py-1 rounded-full text-sm",children:"Guaranteed"}),e.jsx("span",{className:`inline-flex items-center gap-2 px-3 py-1 rounded-full text-sm ${W[l?.line??"DEFAULT"]} text-white`,children:l?.line}),n&&e.jsx("button",{title:`Filter by ${n}`,onClick:()=>S(u=>u===n?null:n),className:`inline-flex items-center gap-2 px-3 py-1 rounded-full text-sm badge-filter ${k===n?"badge-active bg-accent-yellow text-slate-900":"bg-white/6 text-slate-200"}`,children:n})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[(s===j.length-1||o)&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>Ke(s),className:"text-xs px-3 py-1 rounded-full bg-slate-700/30 hover:bg-slate-700/40 text-slate-200 border border-white/6",children:"CHANGE LINE"}),e.jsx("span",{className:`text-xs px-3 py-1 rounded-full text-white ${W[l.line??"DEFAULT"]}`,children:l.line})]}),o&&e.jsx("div",{className:"px-3 py-1 rounded-full bg-slate-700/30 text-xs timeline-small ml-2",children:"END TOUR HERE"})]})]}),s>0&&e.jsx("div",{className:"mt-3",children:e.jsx("span",{className:"inline-flex items-center gap-2 text-xs px-3 py-1 rounded-full bg-blue-900/30 text-blue-300 font-semibold",children:"TRAVEL HERE"})}),e.jsx("div",{className:"mt-4",children:e.jsxs("div",{className:"p-6 rounded-2xl timeline-card border border-white/6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm font-semibold timeline-heading",children:["Day ",s+1]}),e.jsx("div",{className:"text-xs text-slate-400"})]}),e.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[e.jsxs("span",{className:"inline-flex items-center gap-2 bg-white/6 text-slate-200 px-2 py-0.5 rounded-full text-xs",children:["• ",l?.durationDays??j.length,"d"]}),l?.guaranteedDeparture&&e.jsx("span",{className:"inline-flex items-center gap-2 bg-emerald-600/20 text-emerald-200 px-2 py-0.5 rounded-full text-xs",children:"Guaranteed"}),e.jsx("span",{className:`inline-flex items-center gap-2 px-2 py-0.5 rounded-full text-xs ${W[l?.line??"DEFAULT"]} text-white`,children:l?.line}),n&&e.jsx("button",{title:`Filter by ${n}`,onClick:()=>S(u=>u===n?null:n),className:`inline-flex items-center gap-2 px-2 py-0.5 rounded-full text-xs badge-filter ${k===n?"badge-active bg-accent-yellow text-slate-900":"bg-white/6 text-slate-200"}`,children:n})]}),e.jsxs("div",{className:"mt-4 flex items-center gap-3",children:[e.jsx("button",{onClick:()=>R(s),className:"text-sm px-3 py-2 rounded-lg border hover:bg-white/6 text-slate-200",children:"Set as join"}),e.jsx("button",{onClick:()=>T(s),className:"text-sm px-3 py-2 rounded-lg border hover:bg-white/6 text-slate-200",children:"Set as leave"})]})]})}),_===s&&e.jsx("div",{id:`change-panel-${s}`,className:"mt-4 border rounded-2xl bg-white/6 p-4 shadow-sm",children:e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-400 mb-3",children:"SELECT ROUTE TO JOIN"}),e.jsx("div",{className:"space-y-2 max-h-44 overflow-auto pr-2",children:q.map(u=>{const v=W[u.line??"DEFAULT"];return e.jsxs("div",{className:"flex items-center justify-between px-3 py-2 rounded-lg bg-white/6 border hover:shadow-sm transition",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:`w-3.5 h-3.5 rounded-full ${v}`}),e.jsx("div",{className:"text-sm text-slate-200",children:u.title})]}),e.jsx("button",{type:"button",onClick:()=>qe(u.slug),className:"text-sm text-accent-yellow hover:text-accent-yellow-600 underline",children:"Insert"})]},u.slug)})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-400 mb-3",children:"SELECT JOINING POINT (preview)"}),d?e.jsxs("div",{className:"bg-white/6 border rounded-lg p-3",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-200 mb-2",children:d.tour.title}),e.jsx("div",{className:"divide-y",children:d.tour.fullStops?.map((u,v)=>e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-sm text-slate-200",children:u.city}),e.jsx("button",{onClick:()=>{R(s+1+v),T(Math.max(s+1+v,p??s)),ye()},className:"text-xs px-2 py-1 rounded bg-slate-700/20 hover:bg-slate-700/30 text-slate-200",children:"Select"})]},v))}),e.jsxs("div",{className:"mt-3 flex justify-between items-center",children:[e.jsx("div",{className:"text-xs text-slate-400",children:"Preview inserted inline"}),e.jsx("button",{onClick:ye,className:"text-xs text-rose-400 hover:text-rose-300 underline",children:"Remove preview"})]})]}):e.jsx("div",{className:"text-sm text-slate-400",children:"Choose a route to preview stops"})]})]})})]}),e.jsx("div",{className:"w-40 flex flex-col items-start gap-2 pl-4",children:a&&a.length>0?e.jsx("div",{className:"flex flex-col gap-2",children:a.map((u,v)=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"w-2.5 h-2.5 rounded-full",style:{background:u.colorHex}}),e.jsx("span",{className:"text-xs text-slate-300 truncate",style:{maxWidth:120},children:u.city})]},`${s}-${v}`))}):e.jsx("div",{className:"text-xs text-slate-400",children:"—"})})]},`day-${s}`)})}),(g!==null||p!==null)&&e.jsx("div",{className:"flex justify-center mt-6",children:e.jsx("button",{onClick:Qe,className:"w-12 h-12 rounded-full bg-amber-600 text-slate-900 grid place-items-center shadow-lg hover:scale-105 transition-transform",title:"Reset segment",type:"button",children:"✕"})})]})}),e.jsxs("aside",{className:"space-y-6",children:[e.jsxs("div",{className:"rounded-3xl card-glass shadow-lg overflow-hidden",children:[e.jsx("img",{src:l.images?.[0]??"/assets/placeholder.jpg",alt:l.title,className:"w-full h-36 object-cover"}),e.jsxs("div",{className:"p-6 space-y-5 text-slate-200",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-400",children:"Tour Details"}),e.jsxs("div",{className:"mt-3 text-sm",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-slate-400",children:"Start"}),e.jsx("span",{className:"font-medium",children:me(P)})]}),e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[e.jsx("span",{className:"text-xs text-slate-400",children:"End"}),e.jsx("span",{className:"font-medium",children:me(We()??void 0)})]}),e.jsxs("div",{className:"flex items-center justify-between mt-3",children:[e.jsx("span",{className:"text-xs text-slate-400",children:"From"}),e.jsx("span",{className:"font-medium",children:Ye})]}),e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[e.jsx("span",{className:"text-xs text-slate-400",children:"To"}),e.jsx("span",{className:"font-medium",children:Je})]}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsxs("span",{className:"inline-flex items-center gap-2 bg-white/6 text-slate-200 px-3 py-1 rounded-full text-sm",children:["• ",l?.durationDays??j.length," days"]}),l?.guaranteedDeparture&&e.jsx("span",{className:"inline-flex items-center gap-2 bg-emerald-600/20 text-emerald-200 px-3 py-1 rounded-full text-sm",children:"Guaranteed departure"}),je.length>0&&je.map(t=>e.jsx("button",{title:`Filter timeline by ${t}`,onClick:()=>S(s=>s===t?null:t),className:`inline-flex items-center gap-2 px-3 py-1 rounded-full text-sm badge-filter ${k===t?"badge-active bg-accent-yellow text-slate-900":"bg-white/6 text-slate-200"}`,children:t},t)),k&&e.jsx("button",{onClick:()=>S(null),className:"text-xs underline text-slate-300 ml-2",children:"Clear filter"})]})]})]}),e.jsxs("div",{className:"border-t pt-3 text-xs text-slate-400",children:[e.jsx("div",{children:"Duration"}),e.jsxs("div",{className:"text-base font-semibold text-slate-200",children:[he()," Days"]})]}),e.jsxs("div",{className:"border-t pt-3 text-xs text-slate-400",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{children:"Passengers"}),e.jsxs("div",{className:"text-base font-semibold text-slate-200",children:[M," Pax",U&&A>0?` + ${A} Infant(s)`:""]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button","aria-label":"Decrease passengers",onClick:()=>pe(-1),className:"w-8 h-8 rounded-full border flex items-center justify-center hover:bg-white/6 text-slate-200",children:"−"}),e.jsx("input",{"aria-label":"Passengers",className:"w-14 text-center rounded-md border px-2 py-1 text-sm bg-transparent text-slate-200",value:M,onChange:ze,inputMode:"numeric",pattern:"[0-9]*"}),e.jsx("button",{type:"button","aria-label":"Increase passengers",onClick:()=>pe(1),className:"w-8 h-8 rounded-full border flex items-center justify-center hover:bg-white/6 text-slate-200",children:"+"})]})]}),e.jsxs("div",{className:"mt-3 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{id:"infant-checkbox",type:"checkbox",checked:U,onChange:()=>{le(t=>{const s=!t;return s||H(1),s})},className:"w-4 h-4"}),e.jsx("label",{htmlFor:"infant-checkbox",className:"text-sm text-slate-300",children:"Include infant (price TBD)"})]}),U&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button","aria-label":"Decrease infants",onClick:()=>be(-1),className:"w-8 h-8 rounded-full border flex items-center justify-center hover:bg-white/6 text-slate-200",children:"−"}),e.jsx("input",{"aria-label":"Infants",className:"w-14 text-center rounded-md border px-2 py-1 text-sm bg-transparent text-slate-200",value:A,onChange:Oe,inputMode:"numeric",pattern:"[0-9]*"}),e.jsx("button",{type:"button","aria-label":"Increase infants",onClick:()=>be(1),className:"w-8 h-8 rounded-full border flex items-center justify-center hover:bg-white/6 text-slate-200",children:"+"})]})]})]}),e.jsx("div",{className:"border-t pt-4",children:e.jsxs("div",{className:"flex flex-col gap-2",children:[O.lines.map((t,s)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-xs text-slate-400",children:t.label}),e.jsx("div",{className:"text-sm font-semibold text-slate-200",children:t.value})]},s)),O.totalValue?e.jsxs("div",{className:"flex items-center justify-between pt-2 border-t",children:[e.jsx("div",{className:"text-xs text-slate-400",children:O.totalLabel}),e.jsx("div",{className:"text-base font-semibold text-slate-200",children:O.totalValue})]}):null,e.jsxs("div",{className:"flex items-center justify-between pt-3",children:[e.jsx("div",{className:"text-xs text-slate-400",children:"Total"}),e.jsx("div",{className:"text-2xl font-extrabold text-slate-200",children:Ge()})]})]})}),e.jsx("div",{className:"mt-6",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx(Pe,{to:`/tour/${encodeURIComponent(l?.slug??L??"")}`,className:"flex-1 px-3 py-2 border rounded text-center text-sm hover:bg-white/6 text-slate-200",children:"Back to tour"}),e.jsx(Pe,{to:`/booking/${encodeURIComponent(l?.slug??L??"")}`,state:{tour:l,inlineInsert:d,selectedDate:P,passengers:M,perPerson:se().totalPerPerson},className:`flex-1 text-center px-3 py-2 rounded font-semibold text-sm ${ne?"bg-accent-yellow text-slate-900 hover:bg-accent-yellow-600":"bg-white/6 text-slate-400 cursor-not-allowed"}`,"aria-disabled":!ne,onClick:t=>{ne||t.preventDefault()},children:"BOOK NOW"})]})})]})]}),e.jsx("div",{className:"rounded-2xl card-glass p-5 text-sm text-slate-300 shadow-sm",children:"Tip: Select a date to auto-select the full segment. Use the colored markers to fine-tune your join/leave days."})]})]})})]})}export{ot as default};
